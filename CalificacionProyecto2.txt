# PRUEBA GODISK - MIA 2S 2025
# 3 Discos - Validación de errores
# MODIFICAR EL 35 CON LOS ULTIMOS DIGITOS DE SU CARNET
#  1: CREAR DISCOS Y VALIDAR ERRORES

# ERROR: Parámetro incorrecto
mkdisk -param=x -size=30 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoError.mia

# ERROR: Tamaño incorrecto
mkdisk -tamaño=3000 -unit=K -path=/home/josepirir/Calificacion_MIA/Discos/DiscoError.mia

# Disco A - 26MB
mkdisk -size=26 -unit=M -fit=FF -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia

# Disco B - 30MB
mkdisk -size=30 -unit=M -fit=BF -path=/home/josepirir/Calificacion_MIA/Discos/DiscoB.mia

# Disco C - 15MB
mkdisk -size=15 -unit=M -path=/home/josepirir/Calificacion_MIA/Discos/DiscoC.mia

#  2: RMDISK - ELIMINAR DISCOS

# ERROR: Disco no existe
rmdisk -path=/home/josepirir/Calificacion_MIA/Discos/DiscoNoExiste.mia

# Crear discos temporales para pruebas de eliminación
mkdisk -size=10 -unit=M -path=/home/josepirir/Calificacion_MIA/Discos/DiscoTemp1.mia
mkdisk -size=8 -unit=M -path=/home/josepirir/Calificacion_MIA/Discos/DiscoTemp2.mia

# Eliminar discos temporales
rmdisk -path=/home/josepirir/Calificacion_MIA/Discos/DiscoTemp1.mia
rmdisk -path=/home/josepirir/Calificacion_MIA/Discos/DiscoTemp2.mia

# ERROR: Intentar eliminar disco ya eliminado
rmdisk -path=/home/josepirir/Calificacion_MIA/Discos/DiscoTemp1.mia

#  3: FDISK - CREAR PARTICIONES

# ERROR: Ruta no encontrada
fdisk -type=P -unit=M -name=PartError -size=10 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoError.mia -fit=BF

# Disco A - 3 particiones primarias
fdisk -type=P -unit=M -name=PartA1 -size=8 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia -fit=BF
fdisk -type=P -unit=M -name=PartA2 -size=8 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia -fit=BF
fdisk -type=P -unit=M -name=PartA3 -size=8 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia -fit=BF

# ERROR: Límite de particiones primarias
fdisk -type=P -unit=M -name=PartError -size=5 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia -fit=BF

# Disco B - Partición extendida con lógicas
fdisk -type=E -unit=M -name=PartExtB -size=20 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoB.mia -fit=BF
fdisk -type=L -unit=M -name=PartB1 -size=5 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoB.mia -fit=BF
fdisk -type=L -unit=M -name=PartB2 -size=5 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoB.mia -fit=BF
fdisk -type=L -unit=M -name=PartB3 -size=5 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoB.mia -fit=BF

# Disco C - 2 particiones
fdisk -type=P -unit=M -name=PartC1 -size=8 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoC.mia
fdisk -type=P -unit=M -name=PartC2 -size=6 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoC.mia

# ERROR: Falta espacio
fdisk -type=P -unit=M -name=PartError -size=20 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoC.mia

# FASE PRUEBAS DE FDISK ADD Y DELETE

# Agregar 2MB a PartA1
fdisk -add=1 -unit=M -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia -name=PartA1

# Quitar 2MB a PartA1
fdisk -add=-1 -unit=M -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia -name=PartA1

# Crear partición temporal para prueba de DELETE
fdisk -type=P -unit=M -name=PartTempA4 -size=1 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia

# Eliminar partición de forma rápida (Fast)
fdisk -delete=fast -name=PartTempA4 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia

# Crear otra partición temporal en Disco B
fdisk -type=L -unit=M -name=PartTempB4 -size=2 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoB.mia

# Eliminar partición de forma completa (Full - rellena con \0)
fdisk -delete=full -name=PartTempB4 -path=/home/josepirir/Calificacion_MIA/Discos/DiscoB.mia

# ERROR: Intentar eliminar partición que no existe
fdisk -delete=fast -name=PartNoExiste -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia

#  4: MOUNT - MONTAR PARTICIONES

# ERROR: Partición no existe
mount -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia -name=PartNoExiste

# Montar particiones
mount -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia -name=PartA1
mount -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia -name=PartA2
mount -path=/home/josepirir/Calificacion_MIA/Discos/DiscoB.mia -name=PartB1
mount -path=/home/josepirir/Calificacion_MIA/Discos/DiscoC.mia -name=PartC1

# ERROR: Partición ya montada
mount -path=/home/josepirir/Calificacion_MIA/Discos/DiscoA.mia -name=PartA1

# Ver particiones montadas
mounted

# ------------------------------------------------------------------------------------------------------------------------------

#  5: MKFS - FORMATEAR PARTICIONES

# ERROR: ID no encontrado
mkfs -type=full -fs=3fs -id=999X

# Formatear con EXT3 con journaling 
mkfs -type=full -fs=3fs -id=351A

# Formatear con EXT3 con journaling
mkfs -type=full -fs=3fs -id=352A

# Formatear resto con EXT3 (solo particiones primarias y lógicas, NO extendidas)
mkfs -type=full -fs=3fs -id=351C

#  6: LOGIN Y USUARIOS

# Ir a la interfaz web y hacer login con:
# Usuario: root
# Contraseña: 353
# Partición: 351A

login -user=root -pass=123 -id=351A

#  7: CREAR GRUPOS

mkgrp -name=usuarios
mkgrp -name=desarrolladores
mkgrp -name=administradores

# ERROR: Grupo ya existe
mkgrp -name=usuarios

#  8: VER USUARIOS users.txt

cat -file=/users.txt

#  9: ELIMINAR GRUPO

rmgrp -name=desarrolladores

# Ver cambios
cat -file=/users.txt

#  10: CREAR USUARIOS

mkusr -user=user1 -pass=pass353 -grp=usuarios
mkusr -user=user2 -pass=pass353 -grp=usuarios
mkusr -user=admin1 -pass=admin353 -grp=administradores

# ERROR: Usuario ya existe
mkusr -user=user1 -pass=pass353 -grp=usuarios

# ERROR: Grupo no existe
mkusr -user=user3 -pass=pass353 -grp=noexiste

# Ver cambios
cat -file=/users.txt

#  11: CAMBIAR GRUPO DE USUARIO

chgrp -user=user2 -grp=administradores

# Ver cambios
cat -file=/users.txt

#  35: ELIMINAR USUARIO

rmusr -user=user2

# Ver cambios
cat -file=/users.txt


#  13: CREAR DIRECTORIOS

mkdir -path=/home
mkdir -path=/home/user1

# ERROR: No existen carpetas padres
mkdir -path=/home/user1/documentos/proyectos/archivos

# Con flag recursivo
mkdir -p -path=/home/user1/documentos/proyectos
mkdir -p -path=/home/archivos/manuales

#  14: LOGOUT Y LOGIN COMO USUARIO
# NOTA: Logout/Login ahora se hacen SOLO desde la interfaz web

# Ir a la interfaz web y:
# 1. Hacer logout (botón "Cerrar Sesión")
# 2. Hacer login con usuario: user1, contraseña: pass353, partición: 351A
# 3. Hacer logout nuevamente
# 4. Hacer login con usuario: root, contraseña: 353, partición: 351A

#  15: CREAR ARCHIVOS CON MKFILE

# Primero crear archivo fuente con contenido para usar con -contenido=
mkfile -path=/home/fuente.txt -size=100

# Con tamaño 
mkfile -path=/home/user1/archivo1.txt -size=50
mkfile -path=/home/user1/archivo2.txt -size=100

# Con contenido copiado desde archivo existente
mkfile -path=/home/user1/readme.txt -cont=/home/josepirir/fuente.txt

# Con contenido desde archivo existente
mkfile -path=/home/archivos/documento.txt -cont=/home/josepirir/fuente.txt

# ERROR: No existe ruta
mkfile -path=/noexiste/archivo.txt -size=50

# ERROR: Tamaño negativo
mkfile -path=/home/archivo.txt -size=-45

# Con flag recursivo
mkfile -r -path=/home/user1/proyectos/codigo/main.txt -size=75


#  16: LEER ARCHIVOS CON CAT

cat -file=/home/user1/readme.txt
cat -file=/home/archivos/documento.txt
cat -file=/home/archivos/documento.tx
# revisar este
cat -file=/home/user1/archivo1.txt

#  17 y 18: JOURNALING con solo EXT3

# Ver journal de partición EXT3 (352A es EXT3)
journal -id=352A

#  19:  CHMOD

# Cambiar permisos de archivo
chmod -path=/home/user1/readme.txt -ugo=664

# Cambiar permisos de carpeta recursivo 
chmod -path=/home/user1 -ugo=775 -r

# ERROR: Permisos inválidos
chmod -path=/home/user1/readme.txt -ugo=999

#  20:  CHOWN

# Cambiar propietario de archivo
chown -path=/home/user1/archivo1.txt -usuario=admin1
chown -path=/home/user1/archivo1conu -usuario=admin1

# Cambiar propietario de carpeta recursivo
chown -path=/home/user1/documentos -usuario=user1 -r

# ERROR: Usuario no existe
chown -path=/home/user1/readme.txt -usuario=noexiste


#  21:  FIND

# Buscar archivos por nombre exacto
find -path=/home -name=readme.txt

# Buscar con wildcard 
find -path=/home -name=*.txt

# Buscar carpetas
find -path=/home -name=user1

# ERROR: Ruta no existe
find -path=/noexiste -name=archivo.txt

#  22: RENAME

# Renombrar archivo
rename -path=/home/user1/archivo1.txt -name=archivo_renombrado.txt

# Renombrar carpeta
rename -path=/home/user1/documentos -name=docs_user1

# ERROR: Nombre ya existe
rename -path=/home/user1/archivo2.txt -name=readme.txt
#PENDIENTE

# ------------------------------------------------------------------------------------------------------------------------------

#  23:  COPY

# Copiar archivo
copy -path=/home/user1/readme.txt -destino=/home/user1/readme_copia.txt

# ERROR: Destino no existe
copy -path=/home/user1/readme.txt -destino=/noexiste/copia.txt

########## COPY PENDIENTE

#  24:  MOVE

# Mover archivo (archivo2 ya fue renombrado, usar otro)
move -path=/home/user1/readme_copia.txt -destino=/home/readme_movido.txt

# ERROR: Origen no existe
move -path=/noexiste.txt -destino=/home/destino.txt

########## MOVE PENDIENTE

#  25:  EDIT

# Editar archivo con contenido desde archivo existente
edit -path=/home/user1/readme.txt -contenido=/home/fuente.txt

# Verificar cambios
cat -file=/home/user1/readme.txt

# ERROR: Archivo no existe
edit -path=/noexiste.txt -contenido=/home/fuente.txt

########## EDIT PENDIENTE

#  26:  REMOVE

# Eliminar archivo
remove -path=/home/user1/archivo_renombrado.txt

# Eliminar carpeta vacía
remove -path=/home/user1/proyectos/codigo

# ERROR: Carpeta no vacía sin flag -r 
remove -path=/home/docs_user1

# Eliminar carpeta no vacía con flag -r
remove -path=/home/docs_user1 -r

# ERROR: No existe
remove -path=/noexiste.txt

#  27: COMANDOS CRÍTICOS - LOSS Y RECOVERY

# Simular pérdida del sistema (solo EXT3 - usar 352A)
loss -id=352A

# Ver que el journal sigue disponible
journaling -id=352A

# Recuperar el sistema desde journal
recovery -id=352A

# DESMONTAR PARTICIONES

# Primero hacer logout desde la interfaz web

# Desmontar todas las particiones montadas (352A, 353A, 351B que es PartB1, 351C)
unmount -id=352A
unmount -id=353A
unmount -id=351B
unmount -id=351C

# Verificar
mounted